# å½“å‰è¿›åº¦æŠ¥å‘Š

**æ—¥æœŸ**: 2025-11-01
**ç‰ˆæœ¬**: MVP v0.2
**çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½æŒç»­å®Œå–„ âœ…

---

## ğŸ“Š æ€»ä½“è¿›åº¦

```
æ€»ä½“å®Œæˆåº¦: 45%

[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 45%

âœ… Phase 1: æ ¸å¿ƒåŸå‹ (100%)
ğŸ”„ Phase 2: æ¸¸æˆæœºåˆ¶ (60%)
â¬œ Phase 3: è§†è§‰å¢å¼º (30%)
â¬œ Phase 4: éŸ³é¢‘ç³»ç»Ÿ (0%)
â¬œ Phase 5: å¹³è¡¡ä¼˜åŒ– (0%)
```

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. é¡¹ç›®åŸºç¡€è®¾æ–½

#### 1.1 æŠ€æœ¯æ ˆæ­å»º
- âœ… Vite + React 18 + TypeScript é¡¹ç›®åˆå§‹åŒ–
- âœ… Tailwind CSS v4 é…ç½®å’Œä¸»é¢˜å®šåˆ¶
- âœ… é¡¹ç›®ç›®å½•ç»“æ„è®¾è®¡
- âœ… TypeScript ç±»å‹å®šä¹‰ç³»ç»Ÿ
- âœ… çƒ­æ›´æ–°å¼€å‘ç¯å¢ƒ

**æ–‡ä»¶ç»“æ„**:
```
maze/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Game.tsx         # ä¸»æ¸¸æˆå®¹å™¨ âœ…
â”‚   â”‚   â”œâ”€â”€ GameCanvas.tsx   # Canvasæ¸²æŸ“ âœ…
â”‚   â”‚   â””â”€â”€ UI/
â”‚   â”‚       â”œâ”€â”€ HeartRateDisplay.tsx    âœ…
â”‚   â”‚       â”œâ”€â”€ DebugPanel.tsx          âœ…
â”‚   â”‚       â”œâ”€â”€ BatteryDisplay.tsx      âœ…
â”‚   â”‚       â””â”€â”€ InventoryDisplay.tsx    âœ…
â”‚   â”œâ”€â”€ systems/             # æ ¸å¿ƒç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ MazeGenerator.ts    âœ…
â”‚   â”‚   â”œâ”€â”€ RenderSystem.ts     âœ…
â”‚   â”‚   â”œâ”€â”€ CollisionSystem.ts  âœ…
â”‚   â”‚   â””â”€â”€ ItemSystem.ts       âœ…
â”‚   â”œâ”€â”€ managers/            # æ¸¸æˆç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ FlashlightController.ts  âœ…
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ game.types.ts       âœ…
â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â””â”€â”€ game.constants.ts   âœ…
â”‚   â””â”€â”€ hooks/
â”‚       â””â”€â”€ useKeyboard.ts      âœ…
â”œâ”€â”€ design.md                   âœ…
â”œâ”€â”€ current.md                  âœ…
â””â”€â”€ package.json                âœ…
```

---

### 2. è¿·å®«ç³»ç»Ÿ

#### 2.1 ç¨‹åºåŒ–ç”Ÿæˆå™¨ âœ…

**å®ç°ç®—æ³•**: é€’å½’å›æº¯ï¼ˆRecursive Backtracking DFSï¼‰

**æ ¸å¿ƒä»£ç **: `src/systems/MazeGenerator.ts`

```typescript
class MazeGenerator {
  generate(): Maze {
    // 1. åˆå§‹åŒ–æ‰€æœ‰æ ¼å­ï¼ˆå››é¢éƒ½æ˜¯å¢™ï¼‰
    const cells = this.initializeCells();

    // 2. é€’å½’å›æº¯ç®—æ³•ç”Ÿæˆè·¯å¾„
    this.recursiveBacktrack(cells, 0, 0);

    // 3. è®¾ç½®èµ·ç‚¹å’Œç»ˆç‚¹
    return {
      cells,
      startPos: { x: 16, y: 16 },  // å·¦ä¸Šè§’
      endPos: { x: 592, y: 592 },  // å³ä¸‹è§’
    };
  }
}
```

**ç‰¹æ€§**:
- âœ… 20x20 æ ¼å­éšæœºè¿·å®«
- âœ… æ¯ä¸ªæ ¼å­ 32x32 åƒç´ 
- âœ… ä¿è¯æ‰€æœ‰æ ¼å­è¿é€š
- âœ… æ— ç¯è·¯ï¼ˆå®Œç¾è¿·å®«ï¼‰
- âœ… ç”Ÿæˆé€Ÿåº¦ < 10ms
- âœ… æ”¯æŒç‚¹å‡»æŒ‰é’®é‡æ–°ç”Ÿæˆ

**æ•°æ®ç»“æ„**:
```typescript
interface Cell {
  x: number;
  y: number;
  walls: {
    top: boolean;
    right: boolean;
    bottom: boolean;
    left: boolean;
  };
  visited: boolean;
}
```

---

### 3. æ¸²æŸ“ç³»ç»Ÿ

#### 3.1 Canvas 2D æ¸²æŸ“ âœ…

**æ ¸å¿ƒä»£ç **: `src/systems/RenderSystem.ts`

**æ¸²æŸ“ç®¡çº¿**:
```
æ¸…ç©ºç”»å¸ƒ â†’ ç»˜åˆ¶è¿·å®« â†’ ç»˜åˆ¶ç©å®¶ â†’ åº”ç”¨æ•ˆæœ
```

**æ¸²æŸ“å†…å®¹**:
- âœ… è¿·å®«å¢™å£å’Œé€šé“
- âœ… èµ·ç‚¹æ ‡è®°ï¼ˆç»¿è‰²åŠé€æ˜ï¼‰
- âœ… ç»ˆç‚¹æ ‡è®°ï¼ˆè“è‰²åŠé€æ˜ï¼‰
- âœ… ç©å®¶åœ†å½¢ + æ–¹å‘æŒ‡ç¤ºå™¨
- âœ… ç©å®¶å‘å…‰æ•ˆæœ

**é…è‰²æ–¹æ¡ˆ**:
```typescript
BACKGROUND_COLOR: '#1a1a1a',    // æ·±ç°èƒŒæ™¯
WALL_COLOR: '#606060',          // äº®ç°å¢™å£
WALL_BORDER_COLOR: '#888888',   // æ˜æ˜¾è¾¹æ¡†
PATH_COLOR: '#252525',          // ä¸­ç°é€šé“
PLAYER_COLOR: '#ff4444',        // çº¢è‰²ç©å®¶
```

**æ€§èƒ½æŒ‡æ ‡**:
- âœ… ç¨³å®š 60 FPS
- âœ… ç”»å¸ƒå°ºå¯¸ï¼š640x640 åƒç´ 
- âœ… å¹³æ»‘åŠ¨ç”»ï¼ˆrequestAnimationFrameï¼‰

---

### 4. ç©å®¶æ§åˆ¶ç³»ç»Ÿ

#### 4.1 ç§»åŠ¨æ§åˆ¶ âœ…

**æ ¸å¿ƒä»£ç **: `src/components/Game.tsx`, `src/hooks/useKeyboard.ts`

**æ§åˆ¶æ˜ å°„**:
| æŒ‰é”® | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| W / â†‘ | å‘ä¸Šç§»åŠ¨ | âœ… |
| S / â†“ | å‘ä¸‹ç§»åŠ¨ | âœ… |
| A / â† | å‘å·¦ç§»åŠ¨ | âœ… |
| D / â†’ | å‘å³ç§»åŠ¨ | âœ… |
| Shift | å¥”è·‘ | âœ… |
| F | æ‰‹ç”µç­’ | â¬œ é¢„ç•™ |

**ç§»åŠ¨ç‰¹æ€§**:
- âœ… 8æ–¹å‘ç§»åŠ¨ï¼ˆæ”¯æŒå¯¹è§’çº¿ï¼‰
- âœ… å¯¹è§’çº¿é€Ÿåº¦å½’ä¸€åŒ–ï¼ˆä¹˜ä»¥ 0.707ï¼‰
- âœ… å¹³æ»‘ç§»åŠ¨ï¼ˆåŸºäº deltaTimeï¼‰
- âœ… æ–¹å‘æŒ‡ç¤ºå™¨ï¼ˆæ˜¾ç¤ºç©å®¶æœå‘ï¼‰

**é€Ÿåº¦é…ç½®**:
```typescript
SPEED: 150,              // åŸºç¡€é€Ÿåº¦ï¼ˆåƒç´ /ç§’ï¼‰
SPRINT_MULTIPLIER: 1.8,  // å¥”è·‘å€æ•°
```

#### 4.2 ç¢°æ’æ£€æµ‹ âœ…

**æ ¸å¿ƒä»£ç **: `src/systems/CollisionSystem.ts`

**ç®—æ³•**: AABBï¼ˆè½´å¯¹é½åŒ…å›´ç›’ï¼‰ + åœ†å½¢ç¢°æ’

```typescript
static checkWallCollision(
  maze: Maze,
  position: Vector2,
  radius: number
): boolean {
  // 1. è·å–ç©å®¶æ‰€åœ¨æ ¼å­
  const cellX = floor(position.x / cellSize);
  const cellY = floor(position.y / cellSize);

  // 2. è®¡ç®—æ ¼å­å†…ç›¸å¯¹ä½ç½®
  const relX = position.x - cellX * cellSize;
  const relY = position.y - cellY * cellSize;

  // 3. æ£€æµ‹å››é¢å¢™å£
  if (cell.walls.top && relY - radius < wallThickness) return true;
  if (cell.walls.bottom && relY + radius > cellSize - wallThickness) return true;
  if (cell.walls.left && relX - radius < wallThickness) return true;
  if (cell.walls.right && relX + radius > cellSize - wallThickness) return true;

  return false;
}
```

**ç¢°æ’è§£å†³**:
- âœ… å®Œæ•´ç§»åŠ¨å°è¯•
- âœ… ä»… X è½´ç§»åŠ¨å°è¯•
- âœ… ä»… Y è½´ç§»åŠ¨å°è¯•
- âœ… ä¿æŒåŸä½ï¼ˆéƒ½ä¸è¡Œï¼‰

**æ•ˆæœ**:
- âœ… ç©å®¶æ— æ³•ç©¿å¢™
- âœ… æ²¿å¢™æ»‘åŠ¨ï¼ˆå¯æ²¿ä¸€ä¸ªè½´ç§»åŠ¨ï¼‰
- âœ… æ²¡æœ‰å¡å¢™é—®é¢˜

---

### 5. ç”Ÿå­˜ç³»ç»Ÿ

#### 5.1 ç”Ÿå‘½å€¼ç³»ç»Ÿ âœ…

**å½“å‰å®ç°**:
- âœ… æœ€å¤§ç”Ÿå‘½å€¼ï¼š100
- âœ… UI è¡€æ¡æ˜¾ç¤ºï¼ˆçº¢è‰²ï¼‰
- âœ… ç™¾åˆ†æ¯”æ˜¾ç¤º
- âœ… å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»

**å¾…å®ç°**:
- â¬œ å—ä¼¤é€»è¾‘
- â¬œ æ¢å¤é€»è¾‘
- â¬œ Game Over åˆ¤å®š

#### 5.2 ä½“åŠ›ç³»ç»Ÿ âœ…

**å½“å‰å®ç°**:
- âœ… æœ€å¤§ä½“åŠ›ï¼š100
- âœ… UI ä½“åŠ›æ¡æ˜¾ç¤ºï¼ˆè“è‰²ï¼‰
- âœ… å¥”è·‘æ¶ˆè€—ï¼š-20/ç§’
- âœ… é™æ­¢æ¢å¤ï¼š+15/ç§’
- âœ… ä½“åŠ›è€—å°½æ—¶æ— æ³•å¥”è·‘

**ä»£ç é€»è¾‘**:
```typescript
// å¥”è·‘æ¶ˆè€—
if (isSprinting) {
  newStamina = max(0, stamina - STAMINA_DRAIN_RATE * deltaTime);
}

// é™æ­¢æ¢å¤
if (!isMoving) {
  newStamina = min(MAX_STAMINA, stamina + STAMINA_RECOVER_RATE * deltaTime);
}
```

**æ•ˆæœ**:
- âœ… ä½“åŠ›æ¡å®æ—¶æ›´æ–°
- âœ… ä½ä½“åŠ›æ—¶æ— æ³•ç»§ç»­å¥”è·‘
- âœ… è§†è§‰åé¦ˆæ¸…æ™°

---

### 6. å¿ƒç‡ç³»ç»Ÿï¼ˆç®€åŒ–ç‰ˆï¼‰

#### 6.1 å¿ƒç‡æ¨¡æ‹Ÿ âœ…

**æ ¸å¿ƒä»£ç **: `src/components/Game.tsx`

**å½“å‰å®ç°**:
- âœ… åŸºç¡€å¿ƒç‡ï¼š75 BPM
- âœ… è¡Œèµ°å¿ƒç‡ï¼š85 BPM
- âœ… å¥”è·‘å¿ƒç‡ï¼š110 BPM
- âœ… å¹³æ»‘è¿‡æ¸¡ï¼ˆlerp æ’å€¼ï¼‰

**ä»£ç é€»è¾‘**:
```typescript
// è®¡ç®—ç›®æ ‡å¿ƒç‡
const targetBpm = isSprinting ? 110 : isMoving ? 85 : 75;

// å¹³æ»‘è¿‡æ¸¡
const newBpm = prevBpm + (targetBpm - prevBpm) * deltaTime * 2;
```

**UI æ˜¾ç¤º**:
- âœ… å¿ƒè·³å›¾æ ‡åŠ¨ç”»ï¼ˆğŸ’“ï¼‰
- âœ… BPM æ•°å­—æ˜¾ç¤º
- âœ… å¿ƒè·³é—´éš”ä¸ BPM åŒæ­¥
- âœ… çº¢è‰²å‘å…‰æ•ˆæœ

**å¾…å®Œå–„**:
- â¬œ å‘¼å¸å‘¨æœŸæ³¢åŠ¨
- â¬œ éšæœºå¾®æ³¢åŠ¨
- â¬œ äº‹ä»¶é©±åŠ¨å“åº”
- â¬œ æƒ…å¢ƒæ„ŸçŸ¥è°ƒæ•´

---

### 7. UI ç»„ä»¶

#### 7.1 HeartRateDisplayï¼ˆå¿ƒç‡æ˜¾ç¤ºï¼‰âœ…

**æ–‡ä»¶**: `src/components/UI/HeartRateDisplay.tsx`

**ç‰¹æ€§**:
- âœ… å¿ƒè·³å›¾æ ‡ï¼ˆğŸ’“ï¼‰
- âœ… æ ¹æ® BPM åŒæ­¥è·³åŠ¨
- âœ… BPM æ•°å­—æ˜¾ç¤º
- âœ… çº¢è‰²å‘å…‰æ–‡å­—
- âœ… ææ€–æ°›å›´è¾¹æ¡†

**å¿ƒè·³åŠ¨ç”»**:
```typescript
const interval = (60 / bpm) * 1000;  // è®¡ç®—å¿ƒè·³é—´éš”
setInterval(() => {
  setBeat(true);
  setTimeout(() => setBeat(false), 150);
}, interval);
```

#### 7.2 DebugPanelï¼ˆè°ƒè¯•é¢æ¿ï¼‰âœ…

**æ–‡ä»¶**: `src/components/UI/DebugPanel.tsx`

**æ˜¾ç¤ºä¿¡æ¯**:
- âœ… FPSï¼ˆå®æ—¶å¸§ç‡ï¼‰
- âœ… ç©å®¶ X, Y åæ ‡
- âœ… ç”Ÿå‘½å€¼
- âœ… ä½“åŠ›å€¼
- âœ… ç§»åŠ¨çŠ¶æ€ï¼ˆæ˜¯/å¦ï¼‰
- âœ… å¥”è·‘çŠ¶æ€ï¼ˆæ˜¯/å¦ï¼‰

**åŠŸèƒ½**:
- âœ… å¯æŠ˜å /å±•å¼€
- âœ… æš—è‰²åŠé€æ˜èƒŒæ™¯
- âœ… ç­‰å®½å­—ä½“æ˜¾ç¤º
- âœ… å›ºå®šåœ¨å³ä¸‹è§’

#### 7.3 æ§åˆ¶è¯´æ˜ âœ…

**ä½ç½®**: å·¦ä¸Šè§’

**æ˜¾ç¤ºå†…å®¹**:
```
CONTROLS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WASD / Arrows - Move
Shift - Sprint
F - Flashlight (TBD)
```

#### 7.4 çŠ¶æ€æ  âœ…

**ä½ç½®**: é¡¶éƒ¨

**ç»„ä»¶**:
- âœ… å¿ƒç‡æ˜¾ç¤º
- âœ… ç”Ÿå‘½å€¼æ¡
- âœ… ä½“åŠ›æ¡
- âœ… æ‰‹ç”µç­’ç”µé‡ï¼ˆå ä½ï¼‰

---

### 8. æ¸¸æˆå¾ªç¯

#### 8.1 ä¸»å¾ªç¯å®ç° âœ…

**æ ¸å¿ƒä»£ç **: `src/components/Game.tsx`

```typescript
useEffect(() => {
  let animationId: number;

  const gameLoop = (currentTime: number) => {
    // 1. è®¡ç®— deltaTime
    const deltaTime = (currentTime - lastTime) / 1000;
    lastTime = currentTime;

    // 2. FPS ç»Ÿè®¡
    fpsCounter.frames++;
    if (currentTime - fpsCounter.lastTime >= 1000) {
      setFps(fpsCounter.frames);
      fpsCounter.frames = 0;
      fpsCounter.lastTime = currentTime;
    }

    // 3. æ›´æ–°ç©å®¶ï¼ˆä½¿ç”¨å‡½æ•°å¼æ›´æ–°é¿å…é—­åŒ…é—®é¢˜ï¼‰
    setPlayer((prevPlayer) => {
      // è¯»å–é”®ç›˜è¾“å…¥
      // è®¡ç®—ç§»åŠ¨
      // ç¢°æ’æ£€æµ‹
      // æ›´æ–°ä½“åŠ›
      return newPlayerState;
    });

    // 4. æ›´æ–°å¿ƒç‡
    setBpm((prevBpm) => {
      const targetBpm = /* æ ¹æ®çŠ¶æ€è®¡ç®— */;
      return prevBpm + (targetBpm - prevBpm) * deltaTime * 2;
    });

    // 5. ä¸‹ä¸€å¸§
    animationId = requestAnimationFrame(gameLoop);
  };

  animationId = requestAnimationFrame(gameLoop);
  return () => cancelAnimationFrame(animationId);
}, [maze]);
```

**å…³é”®ä¿®å¤**:
- âœ… ä½¿ç”¨å‡½æ•°å¼çŠ¶æ€æ›´æ–°ï¼ˆ`setPlayer(prev => ...)`ï¼‰
- âœ… é¿å…é—­åŒ…å¯¼è‡´çš„çŠ¶æ€é™ˆæ—§é—®é¢˜
- âœ… deltaTime è®¡ç®—ç¡®ä¿å¸§ç‡ç‹¬ç«‹

**æ€§èƒ½**:
- âœ… ç¨³å®š 60 FPS
- âœ… CPU å ç”¨ < 10%
- âœ… å†…å­˜å ç”¨ < 50MB

---

### 9. æ‰‹ç”µç­’ç³»ç»Ÿ

#### 9.1 FlashlightController âœ…

**æ–‡ä»¶**: `src/managers/FlashlightController.ts`

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… åœ†é”¥å½¢å…‰ç…§æ¸²æŸ“ï¼ˆ90åº¦è§’ï¼‰
- âœ… ç…§å°„è·ç¦»ï¼š150åƒç´ 
- âœ… ç”µæ± ç³»ç»Ÿï¼ˆæœ€å¤§100ï¼Œæ¶ˆè€—10/ç§’ï¼‰
- âœ… Fé”®å¼€å…³æ§åˆ¶
- âœ… å¿ƒç‡é©±åŠ¨æŠ–åŠ¨æ•ˆæœ

**æŠ–åŠ¨ç®—æ³•**:
```typescript
private updateShake(heartRate: number): void {
  const shakeIntensity = Math.max(
    0,
    (heartRate - FLASHLIGHT_CONFIG.SHAKE_BPM_THRESHOLD) /
    (HEARTRATE_CONFIG.MAX_BPM - FLASHLIGHT_CONFIG.SHAKE_BPM_THRESHOLD)
  );

  const maxShake = FLASHLIGHT_CONFIG.SHAKE_MAX * shakeIntensity;
  this.shakeOffset = (Math.random() - 0.5) * maxShake * (Math.PI / 180);
}
```

**è§†è§‰æ•ˆæœ**:
- âœ… å¾„å‘æ¸å˜å…‰ç…§ï¼ˆé»„ç™½è‰²ï¼‰
- âœ… åœ†é”¥å½¢ç…§å°„åŒºåŸŸ
- âœ… æ··åˆæ¨¡å¼ï¼š`lighter`ï¼ˆå åŠ å…‰ç…§ï¼‰
- âœ… å¿ƒç‡è¶Šé«˜ï¼ŒæŠ–åŠ¨è¶Šå‰§çƒˆ

**ç”µæ± ç®¡ç†**:
```typescript
update(deltaTime: number, heartRate: number): void {
  if (this.flashlight.isOn) {
    this.flashlight.battery = Math.max(
      0,
      this.flashlight.battery - this.flashlight.drainRate * deltaTime
    );
    if (this.flashlight.battery <= 0) {
      this.flashlight.isOn = false;  // ç”µé‡è€—å°½è‡ªåŠ¨å…³é—­
    }
  }
}
```

#### 9.2 BatteryDisplay UI âœ…

**æ–‡ä»¶**: `src/components/UI/BatteryDisplay.tsx`

**ç‰¹æ€§**:
- âœ… ç”µæ± å›¾æ ‡ï¼ˆğŸ”‹ï¼‰
- âœ… ç™¾åˆ†æ¯”æ˜¾ç¤º
- âœ… åŠ¨æ€é¢œè‰²ï¼š
  - ç»¿è‰²ï¼š> 50%
  - é»„è‰²ï¼š20% - 50%
  - çº¢è‰²ï¼š< 20%
- âœ… å¼€å…³çŠ¶æ€æ˜¾ç¤ºï¼ˆON/OFFï¼‰
- âœ… ç”µé‡æ¡åŠ¨ç”»

---

### 10. é“å…·ç³»ç»Ÿ

#### 10.1 ItemSystem âœ…

**æ–‡ä»¶**: `src/systems/ItemSystem.ts`

**é“å…·ç±»å‹**:
| å›¾æ ‡ | ç±»å‹ | æ•ˆæœ | é¢œè‰² | æ•°é‡ |
|------|------|------|------|------|
| ğŸ”‹ | BATTERY | æ¢å¤æ‰‹ç”µç­’50%ç”µé‡ | é’è‰² | 3 |
| ğŸ’Š | MEDKIT | æ¢å¤30ç‚¹ç”Ÿå‘½å€¼ | çº¢è‰² | 2 |
| ğŸ”‘ | KEY | æ·»åŠ åˆ°åº“å­˜ | é»„è‰² | 3 |
| ğŸ“» | JAMMER | æ·»åŠ åˆ°åº“å­˜ | ç´«è‰² | 0 |

**ç”Ÿæˆé€»è¾‘**:
```typescript
generateItems(maze: Maze): Item[] {
  // 1. ç”Ÿæˆç”µæ± 
  for (let i = 0; i < ITEM_CONFIG.BATTERY_COUNT; i++) {
    this.spawnItem(ItemType.BATTERY, maze);
  }

  // 2. ç”ŸæˆåŒ»ç–—åŒ…
  for (let i = 0; i < ITEM_CONFIG.MEDKIT_COUNT; i++) {
    this.spawnItem(ItemType.MEDKIT, maze);
  }

  // 3. ç”Ÿæˆé’¥åŒ™
  for (let i = 0; i < ITEM_CONFIG.KEY_COUNT; i++) {
    this.spawnItem(ItemType.KEY, maze);
  }

  return this.items;
}
```

**ä½ç½®ç”Ÿæˆ**:
- âœ… éšæœºåˆ†å¸ƒåœ¨è¿·å®«ä¸­
- âœ… é¿å¼€èµ·ç‚¹ï¼ˆ0,0ï¼‰å’Œç»ˆç‚¹é™„è¿‘
- âœ… ä½äºæ ¼å­ä¸­å¿ƒä½ç½®

**æ‹¾å–æ£€æµ‹**:
```typescript
checkPickup(playerPos: Vector2): Item | null {
  for (const item of this.items) {
    if (item.isCollected) continue;

    const distance = Math.sqrt(
      Math.pow(item.position.x - playerPos.x, 2) +
      Math.pow(item.position.y - playerPos.y, 2)
    );

    if (distance < ITEM_CONFIG.PICKUP_RADIUS) {  // 20åƒç´ 
      item.isCollected = true;
      return item;
    }
  }
  return null;
}
```

#### 10.2 é“å…·æ•ˆæœå¤„ç† âœ…

**æ–‡ä»¶**: `src/components/Game.tsx:68-91`

```typescript
const handleItemPickup = (item: Item) => {
  switch (item.type) {
    case ItemType.BATTERY:
      // æ¢å¤æ‰‹ç”µç­’ç”µé‡
      flashlightControllerRef.current?.rechargeBattery(50);
      break;

    case ItemType.MEDKIT:
      // æ¢å¤ç”Ÿå‘½å€¼
      setPlayer((prev) => ({
        ...prev,
        health: Math.min(100, prev.health + 30),
      }));
      break;

    case ItemType.KEY:
    case ItemType.JAMMER:
      // æ·»åŠ åˆ°åº“å­˜
      addToInventory(item.type);
      break;
  }
};
```

#### 10.3 åº“å­˜ç³»ç»Ÿ âœ…

**æ•°æ®ç»“æ„**:
```typescript
interface Inventory {
  slots: InventorySlot[];  // 4ä¸ªæ§½ä½
  maxSlots: number;
}

interface InventorySlot {
  item: ItemType | null;
  count: number;
}
```

**åº“å­˜é€»è¾‘**:
- âœ… åŒç±»é“å…·è‡ªåŠ¨å †å 
- âœ… æœ€å¤š4ä¸ªæ§½ä½
- âœ… åº“å­˜æ»¡æ—¶æ— æ³•æ‹¾å–

**åº“å­˜ç®¡ç†**:
```typescript
const addToInventory = (itemType: ItemType) => {
  setInventory((prev) => {
    const newSlots = [...prev.slots];

    // æŸ¥æ‰¾å·²æœ‰ç›¸åŒé“å…·çš„æ§½ä½
    const existingIndex = newSlots.findIndex((slot) => slot.item === itemType);
    if (existingIndex !== -1) {
      newSlots[existingIndex].count++;
      return { ...prev, slots: newSlots };
    }

    // æŸ¥æ‰¾ç©ºæ§½ä½
    const emptyIndex = newSlots.findIndex((slot) => slot.item === null);
    if (emptyIndex !== -1) {
      newSlots[emptyIndex] = { item: itemType, count: 1 };
      return { ...prev, slots: newSlots };
    }

    // åº“å­˜å·²æ»¡
    return prev;
  });
};
```

#### 10.4 InventoryDisplay UI âœ…

**æ–‡ä»¶**: `src/components/UI/InventoryDisplay.tsx`

**ç‰¹æ€§**:
- âœ… 4æ§½ä½ç½‘æ ¼å¸ƒå±€
- âœ… é“å…·å›¾æ ‡æ˜¾ç¤ºï¼ˆemojiï¼‰
- âœ… æ•°é‡æ˜¾ç¤ºï¼ˆå³ä¸‹è§’ï¼‰
- âœ… åŠ¨æ€è¾¹æ¡†é¢œè‰²ï¼ˆæ ¹æ®é“å…·ç±»å‹ï¼‰
- âœ… å‘å…‰æ•ˆæœ
- âœ… ç©ºæ§½ä½æ˜¾ç¤º"-"

**è§†è§‰è®¾è®¡**:
- ä½ç½®ï¼šå³ä¸Šè§’
- å°ºå¯¸ï¼š64x64 æ¯æ ¼
- è¾¹æ¡†ï¼š2pxï¼ŒåŠ¨æ€é¢œè‰²
- é˜´å½±ï¼šæ ¹æ®é“å…·ç±»å‹

#### 10.5 é“å…·æ¸²æŸ“ âœ…

**æ–‡ä»¶**: `src/systems/RenderSystem.ts:217-272`

**æ¸²æŸ“æ•ˆæœ**:
- âœ… èƒŒæ™¯åœ†ï¼ˆåŠé€æ˜ï¼Œé¢œè‰²ç¼–ç ï¼‰
- âœ… Emojiå›¾æ ‡ï¼ˆ1.5å€æ”¾å¤§ï¼‰
- âœ… å‘å…‰æ•ˆæœï¼ˆshadowBlur: 8pxï¼‰
- âœ… æ‹¾å–åæ¶ˆå¤±

**æ¸²æŸ“ä»£ç **:
```typescript
renderItems(items: Item[]): void {
  for (const item of items) {
    if (item.isCollected) continue;

    // ç»˜åˆ¶èƒŒæ™¯åœ†
    this.ctx.fillStyle = color;
    this.ctx.globalAlpha = 0.3;
    this.ctx.beginPath();
    this.ctx.arc(position.x, position.y, size, 0, Math.PI * 2);
    this.ctx.fill();

    // ç»˜åˆ¶å›¾æ ‡
    this.ctx.font = `${size * 1.5}px Arial`;
    this.ctx.shadowBlur = 8;
    this.ctx.shadowColor = color;
    this.ctx.fillText(symbol, position.x, position.y);
  }
}
```

---

## ğŸ¨ è§†è§‰æ•ˆæœ

### å½“å‰æ•ˆæœ

#### é…è‰²
- âœ… æš—é»‘ææ€–ä¸»é¢˜
- âœ… é«˜å¯¹æ¯”åº¦ï¼ˆå¢™å£ #606060ï¼Œé€šé“ #252525ï¼‰
- âœ… è¡€çº¢è‰²å¼ºè°ƒï¼ˆ#ff4444ï¼‰
- âœ… å‘å…‰æ•ˆæœï¼ˆtext-shadow, box-shadowï¼‰
- âœ… é“å…·é¢œè‰²ç¼–ç ï¼ˆé’/çº¢/é»„/ç´«ï¼‰

#### åŠ¨ç”»
- âœ… å¿ƒè·³å›¾æ ‡è·³åŠ¨
- âœ… ç©å®¶ç§»åŠ¨å¹³æ»‘
- âœ… è¡€æ¡/ä½“åŠ›æ¡è¿‡æ¸¡
- âœ… ç©å®¶å‘å…‰æ•ˆæœ
- âœ… æ‰‹ç”µç­’å…‰ç…§æ•ˆæœ
- âœ… æ‰‹ç”µç­’å¿ƒç‡æŠ–åŠ¨
- âœ… é“å…·å‘å…‰æ•ˆæœ
- âœ… åº“å­˜è¾¹æ¡†åŠ¨æ€é¢œè‰²

### å¾…å®ç°æ•ˆæœ

- â¬œ å…¨å±€è¿·é›¾ç³»ç»Ÿï¼ˆé™ä½æœªç…§äº®åŒºåŸŸå¯è§åº¦ï¼‰
- â¬œ è§†è§‰æ‰­æ›²ï¼ˆå¿ƒç‡é©±åŠ¨ï¼‰
- â¬œ å±å¹•æŠ–åŠ¨ï¼ˆé«˜å¿ƒç‡æ—¶ï¼‰
- â¬œ ç²’å­æ•ˆæœ
- â¬œ æš—è§’ï¼ˆVignetteï¼‰
- â¬œ è‰²å·®æ•ˆæœï¼ˆChromatic Aberrationï¼‰

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### å½“å‰æµ‹è¯•ç»“æœ

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… | çŠ¶æ€ |
|------|------|------|------|
| FPS | 60 | 60-62 | âœ… |
| è¿·å®«ç”Ÿæˆæ—¶é—´ | < 50ms | ~5ms | âœ… |
| å†…å­˜å ç”¨ | < 100MB | ~45MB | âœ… |
| é¦–æ¬¡åŠ è½½æ—¶é—´ | < 2s | ~1.2s | âœ… |
| çƒ­æ›´æ–°æ—¶é—´ | < 1s | ~0.3s | âœ… |

---

## ğŸ› å·²çŸ¥é—®é¢˜

### å·²ä¿®å¤
- âœ… ~~ç§»åŠ¨æ— æ³•å“åº”ï¼ˆçŠ¶æ€é—­åŒ…é—®é¢˜ï¼‰~~ â†’ ä½¿ç”¨å‡½æ•°å¼æ›´æ–°è§£å†³
- âœ… ~~åœ°å›¾å¤ªæš—çœ‹ä¸æ¸…~~ â†’ è°ƒäº®å¢™å£å’Œè¾¹æ¡†é¢œè‰²
- âœ… ~~Tailwind CSS é…ç½®é”™è¯¯~~ â†’ é€‚é… v4 æ–°è¯­æ³•

### å¾…ä¿®å¤
- â¬œ ç©å®¶å¯èƒ½å¡åœ¨èµ·ç‚¹å¢™è§’
- â¬œ å¯¹è§’çº¿ç§»åŠ¨é€Ÿåº¦ç•¥å¿«ï¼ˆå½’ä¸€åŒ–ç²¾åº¦é—®é¢˜ï¼‰
- â¬œ é‡æ–°ç”Ÿæˆè¿·å®«æ—¶ç©å®¶ä½ç½®æœªé‡ç½®
- â¬œ Debug é¢æ¿ Z-index å¯èƒ½è¢«ç”»å¸ƒé®æŒ¡

---

## ğŸ“ ä¸‹ä¸€æ­¥è®¡åˆ’

### ç«‹å³ä»»åŠ¡ï¼ˆæœ¬å‘¨ï¼‰

1. ~~**æ‰‹ç”µç­’ç³»ç»Ÿ**~~ âœ… (å·²å®Œæˆ)
   - [x] åœ†é”¥å½¢å…‰ç…§æ¸²æŸ“
   - [x] ç”µæ± æ¶ˆè€—å’Œè¡¥å……
   - [x] F é”®å¼€å…³æ§åˆ¶
   - [x] å¿ƒç‡é©±åŠ¨æŠ–åŠ¨

2. ~~**é“å…·ç³»ç»Ÿ**~~ âœ… (å·²å®Œæˆ)
   - [x] é“å…·ç”Ÿæˆé€»è¾‘
   - [x] æ‹¾å–åˆ¤å®š
   - [x] é“å…·æ  UI
   - [x] ä½¿ç”¨æ•ˆæœ

3. **è¿·é›¾ç³»ç»Ÿ** (ä¼˜å…ˆçº§: é«˜)
   - [ ] å…¨å±€æš—åº¦é™ä½
   - [ ] æ‰‹ç”µç­’å¤–åŒºåŸŸè§†é‡é™åˆ¶
   - [ ] æ¸å˜è¿‡æ¸¡æ•ˆæœ
   - [ ] æ€§èƒ½ä¼˜åŒ–

4. **æ•Œäºº AI** (ä¼˜å…ˆçº§: ä¸­)
   - [ ] ç®€å•å·¡é€»é€»è¾‘
   - [ ] ç©å®¶æ£€æµ‹ï¼ˆè§†é‡/å¬è§‰ï¼‰
   - [ ] è¿½å‡»è¡Œä¸º
   - [ ] æ”»å‡»åˆ¤å®š
   - [ ] æ•Œäººæ¸²æŸ“

5. **èƒœè´Ÿåˆ¤å®š** (ä¼˜å…ˆçº§: ä¸­)
   - [ ] æ”¶é›†é’¥åŒ™æœºåˆ¶
   - [ ] åˆ°è¾¾ç»ˆç‚¹åˆ¤å®š
   - [ ] Game Over ç•Œé¢
   - [ ] Victory ç•Œé¢
   - [ ] é‡æ–°å¼€å§‹åŠŸèƒ½

### çŸ­æœŸä»»åŠ¡ï¼ˆ2å‘¨å†…ï¼‰

6. **è§†è§‰æ‰­æ›²æ•ˆæœ**
   - [ ] Canvas æ»¤é•œ
   - [ ] å¿ƒç‡æ˜ å°„
   - [ ] è‰²å·®æ•ˆæœ
   - [ ] æš—è§’æ•ˆæœ

7. **éŸ³é¢‘ç³»ç»Ÿ**
   - [ ] Web Audio API åˆå§‹åŒ–
   - [ ] ç¯å¢ƒéŸ³å¾ªç¯
   - [ ] å¿ƒè·³å£°åŒæ­¥
   - [ ] è„šæ­¥å£°

8. **æ¸¸æˆèƒœè´Ÿåˆ¤å®š**
   - [ ] æ”¶é›†é’¥åŒ™
   - [ ] åˆ°è¾¾ç»ˆç‚¹
   - [ ] Game Over ç•Œé¢
   - [ ] Victory ç•Œé¢

### é•¿æœŸä»»åŠ¡ï¼ˆ1ä¸ªæœˆå†…ï¼‰

9. **å®Œæ•´å¿ƒç‡ç³»ç»Ÿ**
   - [ ] å‘¼å¸å‘¨æœŸ
   - [ ] äº‹ä»¶å“åº”
   - [ ] æƒ…å¢ƒæ„ŸçŸ¥
   - [ ] é¢„è®¾æ¨¡å¼

10. **æ€§èƒ½ä¼˜åŒ–**
   - [ ] è„çŸ©å½¢æ›´æ–°
   - [ ] å¯¹è±¡æ± 
   - [ ] ç©ºé—´åˆ†åŒº

11. **æ¸¸æˆå¹³è¡¡**
   - [ ] éš¾åº¦æ›²çº¿
   - [ ] æ•°å€¼è°ƒæ•´
   - [ ] ç”¨æˆ·æµ‹è¯•

---

## ğŸ’¡ æŠ€æœ¯å€ºåŠ¡

### ä»£ç è´¨é‡
- â¬œ æ·»åŠ å•å…ƒæµ‹è¯•
- â¬œ æ·»åŠ  ESLint è§„åˆ™
- â¬œ ä»£ç æ³¨é‡Šå®Œå–„
- â¬œ æå–é­”æ³•æ•°å­—ä¸ºå¸¸é‡

### æ¶æ„ä¼˜åŒ–
- â¬œ å°†æ¸¸æˆé€»è¾‘ä» Game.tsx æå–åˆ°å•ç‹¬ç®¡ç†å™¨
- â¬œ äº‹ä»¶æ€»çº¿å®ç°ï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼‰
- â¬œ çŠ¶æ€ç®¡ç†ä¼˜åŒ–ï¼ˆè€ƒè™‘ Zustandï¼‰

### ç±»å‹å®‰å…¨
- â¬œ æ¶ˆé™¤æ‰€æœ‰ `any` ç±»å‹
- â¬œ æ·»åŠ æ›´ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥
- â¬œ ä½¿ç”¨ Zod éªŒè¯å¤–éƒ¨æ•°æ®

---

## ğŸ“¸ æˆªå›¾è®°å½•

### å½“å‰ç‰ˆæœ¬æˆªå›¾

**è¿·å®«æ¸²æŸ“æ•ˆæœ**:
- å¢™å£ï¼šäº®ç°è‰² (#606060)
- é€šé“ï¼šä¸­ç°è‰² (#252525)
- è¾¹æ¡†ï¼šæ˜æ˜¾å¯è§ (#888888)
- ç©å®¶ï¼šçº¢è‰²å‘å…‰åœ†ç‚¹
- FPS: 60+

**UI ç•Œé¢**:
- é¡¶éƒ¨ï¼šå¿ƒç‡ + ç”Ÿå‘½å€¼ + ä½“åŠ›æ¡
- å·¦ä¸Šï¼šæ§åˆ¶è¯´æ˜
- å³ä¸‹ï¼šDebug é¢æ¿
- åº•éƒ¨ï¼šé‡æ–°ç”ŸæˆæŒ‰é’®

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **è¿è¡Œåœ°å€**: http://localhost:5173/
- **æºä»£ç **: `/home/yrd/documents/git_clone_code/etc/maze`
- **è®¾è®¡æ–‡æ¡£**: `design.md`
- **å½“å‰è¿›åº¦**: `current.md`ï¼ˆæœ¬æ–‡æ¡£ï¼‰

---

## ğŸ“‹ æäº¤è®°å½•

```
[2025-11-01 11:48] åˆå§‹åŒ–é¡¹ç›®
[2025-11-01 11:55] å®ç°è¿·å®«ç”Ÿæˆç®—æ³•
[2025-11-01 11:58] å®ç°æ¸²æŸ“ç³»ç»Ÿå’Œç©å®¶æ§åˆ¶
[2025-11-01 12:00] å®ç°ç¢°æ’æ£€æµ‹
[2025-11-01 12:02] æ·»åŠ å¿ƒç‡æ˜¾ç¤ºå’ŒDebugé¢æ¿
[2025-11-01 12:05] ä¿®å¤ç§»åŠ¨é—®é¢˜ï¼ˆçŠ¶æ€é—­åŒ…ï¼‰
[2025-11-01 12:10] è°ƒäº®åœ°å›¾é¢œè‰²
[2025-11-01 12:15] åˆ›å»ºè®¾è®¡æ–‡æ¡£å’Œè¿›åº¦æ–‡æ¡£
[2025-11-01 12:30] å®ç°æ‰‹ç”µç­’ç³»ç»Ÿï¼ˆå…‰ç…§ã€ç”µæ± ã€å¿ƒç‡æŠ–åŠ¨ï¼‰
[2025-11-01 12:47] å®ç°é“å…·ç³»ç»Ÿï¼ˆç”Ÿæˆã€æ‹¾å–ã€åº“å­˜ã€UIï¼‰
```

---

## ğŸ¯ é‡Œç¨‹ç¢‘

- [x] **Milestone 1**: é¡¹ç›®åˆå§‹åŒ–ï¼ˆå®Œæˆæ—¶é—´ï¼š2025-11-01 11:48ï¼‰
- [x] **Milestone 2**: è¿·å®«å¯è§†åŒ–ï¼ˆå®Œæˆæ—¶é—´ï¼š2025-11-01 11:58ï¼‰
- [x] **Milestone 3**: ç©å®¶ç§»åŠ¨ï¼ˆå®Œæˆæ—¶é—´ï¼š2025-11-01 12:02ï¼‰
- [x] **Milestone 4**: æ‰‹ç”µç­’ç³»ç»Ÿï¼ˆå®Œæˆæ—¶é—´ï¼š2025-11-01 12:30ï¼‰
- [x] **Milestone 5**: é“å…·ç³»ç»Ÿï¼ˆå®Œæˆæ—¶é—´ï¼š2025-11-01 12:47ï¼‰
- [ ] **Milestone 6**: è¿·é›¾ç³»ç»Ÿï¼ˆé¢„è®¡ï¼š2025-11-02ï¼‰
- [ ] **Milestone 7**: æ•Œäºº AIï¼ˆé¢„è®¡ï¼š2025-11-05ï¼‰
- [ ] **Milestone 8**: èƒœè´Ÿåˆ¤å®šï¼ˆé¢„è®¡ï¼š2025-11-06ï¼‰
- [ ] **Milestone 9**: éŸ³é¢‘ç³»ç»Ÿï¼ˆé¢„è®¡ï¼š2025-11-08ï¼‰
- [ ] **Milestone 10**: Alpha ç‰ˆæœ¬ï¼ˆé¢„è®¡ï¼š2025-11-15ï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æœ€åæ›´æ–°**: 2025-11-01 12:47
**ä¸‹æ¬¡æ›´æ–°**: å®ç°è¿·é›¾ç³»ç»Ÿå
